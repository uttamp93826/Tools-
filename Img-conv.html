<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF to Image Converter</title>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX" crossorigin="anonymous"></script>
    <style>
        :root {
            --primary-color: #4a6bff;
            --secondary-color: #f5f7ff;
            --text-color: #333;
            --light-text: #666;
            --border-color: #ddd;
            --hover-color: #3a5bef;
            --error-color: #ff4a4a;
            --success-color: #4caf50;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: #f9f9f9;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            margin-bottom: 5px;
            color: var(--primary-color);
        }

        .subtitle {
            text-align: center;
            color: var(--light-text);
            margin-bottom: 30px;
        }

        .upload-area {
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 25px;
            transition: all 0.3s;
            background-color: var(--secondary-color);
        }

        .upload-area:hover {
            border-color: var(--primary-color);
        }

        .upload-area.drag-over {
            border-color: var(--primary-color);
            background-color: rgba(74, 107, 255, 0.05);
        }

        .upload-button {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 12px 24px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: background-color 0.3s;
        }

        .upload-button:hover {
            background-color: var(--hover-color);
        }

        .drag-text {
            margin: 15px 0;
            color: var(--light-text);
        }

        .file-info {
            font-size: 14px;
            color: var(--light-text);
        }

        .options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .option-group {
            margin-bottom: 15px;
        }

        .option-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .option-group select, 
        .option-group input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 14px;
        }

        .option-group input[type="range"] {
            width: calc(100% - 50px);
            vertical-align: middle;
        }

        .option-group span {
            display: inline-block;
            width: 40px;
            text-align: right;
            margin-left: 10px;
            font-size: 14px;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .checkbox-group input {
            width: auto;
        }

        .convert-button {
            display: block;
            width: 100%;
            padding: 14px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-bottom: 30px;
        }

        .convert-button:hover {
            background-color: var(--hover-color);
        }

        .convert-button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        .results {
            margin-top: 20px;
        }

        .loading {
            text-align: center;
            padding: 30px;
        }

        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top: 4px solid var(--primary-color);
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .download-all {
            text-align: center;
            margin-bottom: 20px;
        }

        .download-button {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 10px 20px;
            background-color: var(--success-color);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 15px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .download-button:hover {
            background-color: #3d8b40;
        }

        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .image-card {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .image-container {
            height: 200px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f5f5f5;
        }

        .image-container img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .image-info {
            padding: 12px;
            font-size: 14px;
        }

        .image-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }

        .image-actions button {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            font-size: 13px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .download-btn {
            background-color: var(--primary-color);
            color: white;
        }

        .download-btn:hover {
            background-color: var(--hover-color);
        }

        .view-btn {
            background-color: #e0e0e0;
        }

        .view-btn:hover {
            background-color: #d0d0d0;
        }

        /* Ad container styles */
        .ad-container {
            width: 100%;
            margin: 20px 0;
            text-align: center;
            min-height: 90px;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #f5f5f5;
            border-radius: 4px;
            overflow: hidden;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            .options {
                grid-template-columns: 1fr;
            }
            
            .image-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            .upload-button {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Top Ad Container -->
    <div class="ad-container">
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
             data-ad-slot="XXXXXXXXXX"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>

    <div class="container">
        <h1>PDF to Image Converter</h1>
        <p class="subtitle">Convert PDF pages to high-quality images</p>
        
        <div class="upload-area" id="dropArea">
            <input type="file" id="pdfInput" accept=".pdf" hidden>
            <label for="pdfInput" class="upload-button">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="17 8 12 3 7 8"></polyline>
                    <line x1="12" y1="3" x2="12" y2="15"></line>
                </svg>
                <span>Select PDF File</span>
            </label>
            <p class="drag-text">or drag & drop PDF here</p>
            <p class="file-info" id="fileInfo">No file selected</p>
        </div>
        
        <div class="options">
            <div class="option-group">
                <label for="imageFormat">Output Format:</label>
                <select id="imageFormat">
                    <option value="jpeg">JPEG</option>
                    <option value="png">PNG</option>
                    <option value="webp">WebP</option>
                </select>
            </div>
            
            <div class="option-group">
                <label for="quality">Quality (JPEG only):</label>
                <input type="range" id="quality" min="1" max="100" value="90">
                <span id="qualityValue">90%</span>
            </div>
            
            <div class="option-group">
                <label for="scale">Scale:</label>
                <input type="range" id="scale" min="0.5" max="3" step="0.1" value="1.5">
                <span id="scaleValue">1.5x</span>
            </div>
            
            <div class="option-group checkbox-group">
                <input type="checkbox" id="allPages" checked>
                <label for="allPages">Convert all pages</label>
            </div>
            
            <div class="option-group" id="pageRangeGroup" style="display: none;">
                <label for="pageRange">Pages to convert (e.g., 1-3,5):</label>
                <input type="text" id="pageRange" placeholder="1-3,5,7-9">
            </div>
        </div>
        
        <button id="convertBtn" class="convert-button" disabled>Convert to Images</button>
        
        <div class="results" id="results">
            <div class="loading" id="loading" style="display: none;">
                <div class="spinner"></div>
                <p>Processing PDF...</p>
            </div>
            
            <div class="download-all" id="downloadAll" style="display: none;">
                <button id="downloadZipBtn" class="download-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    Download All as ZIP
                </button>
            </div>
            
            <div class="image-grid" id="imageGrid"></div>
        </div>
    </div>

    <!-- Bottom Ad Container -->
    <div class="ad-container">
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
             data-ad-slot="XXXXXXXXXX"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    
    <script>
        // Initialize PDF.js worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.worker.min.js';

        // DOM elements
        const pdfInput = document.getElementById('pdfInput');
        const dropArea = document.getElementById('dropArea');
        const fileInfo = document.getElementById('fileInfo');
        const convertBtn = document.getElementById('convertBtn');
        const imageFormat = document.getElementById('imageFormat');
        const quality = document.getElementById('quality');
        const qualityValue = document.getElementById('qualityValue');
        const scale = document.getElementById('scale');
        const scaleValue = document.getElementById('scaleValue');
        const allPages = document.getElementById('allPages');
        const pageRangeGroup = document.getElementById('pageRangeGroup');
        const pageRange = document.getElementById('pageRange');
        const loading = document.getElementById('loading');
        const downloadAll = document.getElementById('downloadAll');
        const downloadZipBtn = document.getElementById('downloadZipBtn');
        const imageGrid = document.getElementById('imageGrid');
        const results = document.getElementById('results');

        // Variables
        let pdfFile = null;
        let pdfDoc = null;
        let imagesData = [];

        // Event listeners
        pdfInput.addEventListener('change', handleFileSelect);
        dropArea.addEventListener('click', () => pdfInput.click());
        dropArea.addEventListener('dragover', handleDragOver);
        dropArea.addEventListener('dragleave', handleDragLeave);
        dropArea.addEventListener('drop', handleDrop);
        convertBtn.addEventListener('click', convertPdfToImages);
        allPages.addEventListener('change', togglePageRange);
        quality.addEventListener('input', updateQualityValue);
        scale.addEventListener('input', updateScaleValue);
        downloadZipBtn.addEventListener('click', downloadAllImagesAsZip);

        // Update quality value display
        function updateQualityValue() {
            qualityValue.textContent = `${quality.value}%`;
        }

        // Update scale value display
        function updateScaleValue() {
            scaleValue.textContent = `${scale.value}x`;
        }

        // Toggle page range input visibility
        function togglePageRange() {
            pageRangeGroup.style.display = allPages.checked ? 'none' : 'block';
        }

        // Handle file selection
        function handleFileSelect(e) {
            const file = e.target.files[0];
            if (file && file.type === 'application/pdf') {
                pdfFile = file;
                fileInfo.textContent = `Selected: ${file.name}`;
                convertBtn.disabled = false;
            } else {
                alert('Please select a valid PDF file.');
            }
        }

        // Handle drag over
        function handleDragOver(e) {
            e.preventDefault();
            e.stopPropagation();
            dropArea.classList.add('drag-over');
        }

        // Handle drag leave
        function handleDragLeave(e) {
            e.preventDefault();
            e.stopPropagation();
            dropArea.classList.remove('drag-over');
        }

        // Handle drop
        function handleDrop(e) {
            e.preventDefault();
            e.stopPropagation();
            dropArea.classList.remove('drag-over');
            
            const file = e.dataTransfer.files[0];
            if (file && file.type === 'application/pdf') {
                pdfFile = file;
                fileInfo.textContent = `Selected: ${file.name}`;
                convertBtn.disabled = false;
                pdfInput.files = e.dataTransfer.files; // Set the file input
            } else {
                alert('Please drop a valid PDF file.');
            }
        }

        // Convert PDF to images
        async function convertPdfToImages() {
            if (!pdfFile) return;
            
            // Reset previous results
            imageGrid.innerHTML = '';
            imagesData = [];
            loading.style.display = 'block';
            downloadAll.style.display = 'none';
            
            try {
                // Read the PDF file
                const arrayBuffer = await readFileAsArrayBuffer(pdfFile);
                pdfDoc = await pdfjsLib.getDocument(arrayBuffer).promise;
                
                // Determine which pages to convert
                const pagesToConvert = await getPagesToConvert(pdfDoc.numPages);
                
                // Convert each page to an image
                for (const pageNum of pagesToConvert) {
                    const imageData = await convertPageToImage(pageNum);
                    imagesData.push(imageData);
                }
                
                // Display the images
                displayImages(imagesData);
                
            } catch (error) {
                console.error('Error converting PDF:', error);
                alert('An error occurred while converting the PDF. Please try again.');
            } finally {
                loading.style.display = 'none';
            }
        }

        // Read file as ArrayBuffer
        function readFileAsArrayBuffer(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsArrayBuffer(file);
            });
        }

        // Get array of page numbers to convert
        async function getPagesToConvert(totalPages) {
            if (allPages.checked) {
                return Array.from({ length: totalPages }, (_, i) => i + 1);
            }
            
            // Parse page range input (e.g., "1-3,5,7-9")
            const rangeText = pageRange.value.trim();
            if (!rangeText) return [1]; // Default to first page if no range specified
            
            const pages = new Set();
            const parts = rangeText.split(',');
            
            for (const part of parts) {
                if (part.includes('-')) {
                    const [start, end] = part.split('-').map(Number);
                    const rangeStart = Math.min(start, end);
                    const rangeEnd = Math.max(start, end);
                    
                    for (let i = rangeStart; i <= rangeEnd; i++) {
                        if (i >= 1 && i <= totalPages) {
                            pages.add(i);
                        }
                    }
                } else {
                    const pageNum = Number(part);
                    if (pageNum >= 1 && pageNum <= totalPages) {
                        pages.add(pageNum);
                    }
                }
            }
            
            return Array.from(pages).sort((a, b) => a - b);
        }

        // Convert a single PDF page to an image
        async function convertPageToImage(pageNum) {
            const page = await pdfDoc.getPage(pageNum);
            const viewport = page.getViewport({ scale: parseFloat(scale.value) });
            
            // Create canvas for rendering
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            canvas.height = viewport.height;
            canvas.width = viewport.width;
            
            // Render PDF page to canvas
            await page.render({
                canvasContext: context,
                viewport: viewport
            }).promise;
            
            // Get image data URL
            const format = imageFormat.value;
            let qualityValue = format === 'jpeg' ? parseInt(quality.value) / 100 : 1;
            const imageUrl = canvas.toDataURL(`image/${format}`, qualityValue);
            
            return {
                pageNum,
                imageUrl,
                format,
                width: canvas.width,
                height: canvas.height
            };
        }

        // Display converted images
        function displayImages(images) {
            if (images.length === 0) {
                imageGrid.innerHTML = '<p class="no-images">No images were generated.</p>';
                return;
            }
            
            images.forEach(imageData => {
                const imageCard = document.createElement('div');
                imageCard.className = 'image-card';
                
                imageCard.innerHTML = `
                    <div class="image-container">
                        <img src="${imageData.imageUrl}" alt="Page ${imageData.pageNum}">
                    </div>
                    <div class="image-info">
                        <p>Page ${imageData.pageNum}</p>
                        <p>${imageData.width} × ${imageData.height} px</p>
                        <div class="image-actions">
                            <button class="view-btn" onclick="viewImage('${imageData.imageUrl}')">View</button>
                            <button class="download-btn" onclick="downloadImage(${imageData.pageNum}, '${imageData.format}')">Download</button>
                        </div>
                    </div>
                `;
                
                imageGrid.appendChild(imageCard);
            });
            
            // Show download all button if there are multiple images
            if (images.length > 1) {
                downloadAll.style.display = 'block';
            }
        }

        // View image in full screen
        function viewImage(imageUrl) {
            const overlay = document.createElement('div');
            overlay.style.position = 'fixed';
            overlay.style.top = '0';
            overlay.style.left = '0';
            overlay.style.width = '100%';
            overlay.style.height = '100%';
            overlay.style.backgroundColor = 'rgba(0, 0, 0, 0.9)';
            overlay.style.display = 'flex';
            overlay.style.alignItems = 'center';
            overlay.style.justifyContent = 'center';
            overlay.style.zIndex = '1000';
            overlay.style.cursor = 'zoom-out';
            
            const img = document.createElement('img');
            img.src = imageUrl;
            img.style.maxWidth = '90%';
            img.style.maxHeight = '90%';
            img.style.objectFit = 'contain';
            
            overlay.appendChild(img);
            overlay.addEventListener('click', () => document.body.removeChild(overlay));
            
            document.body.appendChild(overlay);
        }

        // Download single image
        function downloadImage(pageNum, format) {
            const imageData = imagesData.find(img => img.pageNum === pageNum);
            if (!imageData) return;
            
            const link = document.createElement('a');
            link.href = imageData.imageUrl;
            link.download = `page_${pageNum}.${format}`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Download all images as ZIP
        function downloadAllImagesAsZip() {
            if (imagesData.length === 0) return;
            
            const zip = new JSZip();
            const imgFolder = zip.folder('pdf_images');
            
            imagesData.forEach(imageData => {
                // Convert data URL to blob
                const blob = dataURLtoBlob(imageData.imageUrl);
                imgFolder.file(`page_${imageData.pageNum}.${imageData.format}`, blob);
            });
            
            zip.generateAsync({ type: 'blob' }).then(content => {
                saveAs(content, 'pdf_images.zip');
            });
        }

        // Convert data URL to blob
        function dataURLtoBlob(dataURL) {
            const arr = dataURL.split(',');
            const mime = arr[0].match(/:(.*?);/)[1];
            const bstr = atob(arr[1]);
            let n = bstr.length;
            const u8arr = new Uint8Array(n);
            
            while (n--) {
                u8arr[n] = bstr.charCodeAt(n);
            }
            
            return new Blob([u8arr], { type: mime });
        }

        // Initialize ads
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</body>
</html>
